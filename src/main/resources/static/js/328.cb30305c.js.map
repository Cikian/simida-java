{"version":3,"file":"js/328.cb30305c.js","mappings":"uvBASA,MAAMA,GAAOC,EAAAA,EAAAA,IAAI,CACfC,MAAO,GACPC,SAAU,GACVC,iBAAkB,KAEdC,GAAgBJ,EAAAA,EAAAA,IAAI,OAE1BK,EAAAA,EAAAA,KAAU,KACRN,EAAKO,MAAML,MAAQM,EAAAA,EAAMC,SAASP,KAAK,IAGzC,MAAMQ,EAA2BA,CAACC,EAAMC,EAAOC,KAC7CC,EAAAA,EAAaH,GAAM,CACjBI,QAASH,EACTC,YAAaA,EACbG,SAAU,GACV,EAIEC,GAAQhB,EAAAA,EAAAA,IAAI,GAEZiB,GAAajB,EAAAA,EAAAA,IAAI,CACrBkB,KAAM,QACNC,UAAU,IAGNC,EAAUA,KACdC,EAAAA,EAAeC,KAAK,qCAAsC,CACxDC,GAAIxB,EAAKO,MAAML,MACfuB,QAAS,UACTb,MAAO,OACPc,IAAK,SACJC,MAAMC,IACe,OAAlBA,EAAIC,KAAKC,MACXpB,EAAyB,UAAWkB,EAAIC,KAAKH,KAC7CR,EAAWX,MAAMa,UAAW,EAC5BF,EAAWX,MAAMY,KAAO,GACxBF,EAAMV,MAAQwB,KAAKC,MAAQ,KAE3BtB,EAAyB,UAAWkB,EAAIC,KAAKH,IAC/C,GACA,EAGEO,EAAcA,KAClBhB,EAAMV,MAAQ,EACdW,EAAWX,MAAMY,KAAO,OACxBD,EAAWX,MAAMa,UAAW,CAAK,EAG7Bc,GAAQC,EAAAA,EAAAA,IAAS,CACrBhC,SAAU,CACR,CAACiC,UAAU,EAAMrB,QAAS,SAAUsB,QAAS,SAE/CnC,MAAO,CACL,CAACkC,UAAU,EAAMrB,QAAS,SAAUsB,QAAS,QAC7C,CAAC1B,KAAM,QAASI,QAAS,aAAcsB,QAAS,SAElDjC,iBAAkB,CAChB,CAACgC,UAAU,EAAMrB,QAAS,UAAWsB,QAAS,WAI5CC,EAAYA,KACS,KAArBtC,EAAKO,MAAML,QACbgB,EAAWX,MAAMa,UAAW,EAC9B,EAGImB,EAAaC,UAEZC,SACCA,EAAOC,UAASF,MAAOG,EAAOC,KAC9BD,GACFE,GACF,GACA,EAGEA,EAAeA,KACnBvB,EAAAA,EAAewB,IAAI,uBAAwB,CACrC3C,SAAUH,EAAKO,MAAMJ,SACrBC,iBAAkBJ,EAAKO,MAAMH,kBAE/B,CACE2C,QAAS,CAAC,eAAgB,uCAE9BpB,MAAMC,IACgB,OAAlBA,EAAIC,KAAKC,MACXpB,EAAyB,UAAW,eACpCsC,aAAaC,WAAW,YACxBD,aAAaC,WAAW,SACxBD,aAAaC,WAAW,OACxBD,aAAaC,WAAW,QACxBzC,EAAAA,EAAMC,SAAW,CAAC,EAClBD,EAAAA,EAAM0C,SAAU,EAChB1C,EAAAA,EAAM2C,OAAS,cACfC,EAAAA,EAAOC,KAAK,iBAEZ3C,EAAyB,QAASkB,EAAIC,KAAKH,IAC7C,GACA,E,y7DCzGJ,MAAM4B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://simida-web/./src/views/socialFeedModel/home/pages/editUserMsg/editPasswd.vue","webpack://simida-web/./src/views/socialFeedModel/home/pages/editUserMsg/editPasswd.vue?f6f0"],"sourcesContent":["<script setup>\r\n\r\nimport {ElButton, ElForm, ElInput} from \"element-plus\";\r\nimport {notification} from \"ant-design-vue\";\r\nimport requestService from \"@/utils/request\";\r\nimport {onMounted, reactive, ref} from \"vue\";\r\nimport {store} from \"@/store\";\r\nimport router from \"@/router\";\r\n\r\nconst form = ref({\r\n  email: '',\r\n  password: '',\r\n  verificationCode: ''\r\n})\r\nconst passwdFormRef = ref(null);\r\n\r\nonMounted(() => {\r\n  form.value.email = store.userInfo.email\r\n})\r\n\r\nconst openNotificationWithIcon = (type, title, description) => {\r\n  notification[type]({\r\n    message: title,\r\n    description: description,\r\n    duration: 2\r\n  });\r\n};\r\n\r\n\r\nconst timer = ref(0);\r\n\r\nconst getCodeBtn = ref({\r\n  text: '获取验证码',\r\n  disabled: true\r\n})\r\n\r\nconst getCode = () => {\r\n  requestService.post(\"/mail/sendVerificationCodeHtmlMail\", {\r\n    to: form.value.email,\r\n    subject: \"身份校验验证码\",\r\n    title: \"邮箱验证\",\r\n    msg: \"修改密码\"\r\n  }).then((res) => {\r\n    if (res.data.code === 1001) {\r\n      openNotificationWithIcon('success', res.data.msg)\r\n      getCodeBtn.value.disabled = true\r\n      getCodeBtn.value.text = ''\r\n      timer.value = Date.now() + 1000 * 60\r\n    } else {\r\n      openNotificationWithIcon('warning', res.data.msg)\r\n    }\r\n  })\r\n};\r\n\r\nconst timerFinish = () => {\r\n  timer.value = 0;\r\n  getCodeBtn.value.text = '重新获取';\r\n  getCodeBtn.value.disabled = false;\r\n};\r\n\r\nconst rules = reactive({\r\n  password: [\r\n    {required: true, message: '密码不能为空', trigger: 'blur'},\r\n  ],\r\n  email: [\r\n    {required: true, message: '邮箱不能为空', trigger: 'blur'},\r\n    {type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur'},\r\n  ],\r\n  verificationCode: [\r\n    {required: true, message: '验证码不能为空', trigger: 'blur'},\r\n  ],\r\n});\r\n\r\nconst emailBlur = () => {\r\n  if (form.value.email !== '') {\r\n    getCodeBtn.value.disabled = false\r\n  }\r\n}\r\n\r\nconst submitForm = async (formEl) => {\r\n\r\n  if (!formEl) return;\r\n  await formEl.validate(async (valid, fields) => {\r\n    if (valid) {\r\n      updatePasswd()\r\n    }\r\n  });\r\n};\r\n\r\nconst updatePasswd = () => {\r\n  requestService.put(\"/user/changePassword\", {\r\n        password: form.value.password,\r\n        verificationCode: form.value.verificationCode\r\n      },\r\n      {\r\n        headers: {\"Content-Type\": \"application/x-www-form-urlencoded\"},\r\n      }\r\n  ).then((res) => {\r\n    if (res.data.code === 4001) {\r\n      openNotificationWithIcon('success', \"修改成功，请重新登录！\")\r\n      localStorage.removeItem(\"userInfo\")\r\n      localStorage.removeItem(\"token\");\r\n      localStorage.removeItem(\"uid\");\r\n      localStorage.removeItem(\"tour\");\r\n      store.userInfo = {};\r\n      store.isLogin = false;\r\n      store.active = \"recommended\";\r\n      router.push(\"/recommended\");\r\n    } else {\r\n      openNotificationWithIcon('error', res.data.msg)\r\n    }\r\n  })\r\n}\r\n\r\n\r\n</script>\r\n\r\n<template>\r\n  <div class=\"content\">\r\n    <div :style=\"{fontSize:'24px',paddingTop:'20px',paddingBottom:'30px',display:'flex',justifyContent:'center'}\">\r\n      修改密码\r\n    </div>\r\n\r\n    <div\r\n        :style=\"{fontSize:'20px',paddingTop:'20px',paddingBottom:'30px',display:'flex',justifyContent:'center',color:'#de1c31'}\">\r\n      通过邮箱验证身份\r\n    </div>\r\n\r\n    <div>\r\n      <el-form ref=\"passwdFormRef\"\r\n               :model=\"form\"\r\n               :rules=\"rules\"\r\n               :style=\"{width:'550px',margin:'20px auto'}\">\r\n        <el-form-item prop=\"email\">\r\n          <el-input type=\"email\" v-model=\"form.email\" class=\"input-with-select\" clearable @blur=\"emailBlur\" disabled>\r\n            <template #prepend>\r\n              邮&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;箱\r\n            </template>\r\n            <template #prefix>\r\n              <font-awesome-icon icon=\"fa-solid fa-envelope\"/>\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"verificationCode\">\r\n          <el-input v-model=\"form.verificationCode\" class=\"input-with-select\">\r\n            <template #prepend>\r\n              验&nbsp;&nbsp;证&nbsp;&nbsp;码\r\n            </template>\r\n            <template #prefix>\r\n              <font-awesome-icon icon=\"fa-solid fa-envelope-open-text\"/>\r\n            </template>\r\n            <template #suffix>\r\n              <el-button type=\"primary\" @click=\"getCode\"\r\n                         style=\"min-width: 90px;max-width: 90px;\">\r\n                {{ getCodeBtn.text }}\r\n                <el-countdown value-style=\"color: #fff\" :value=\"timer\" format=\"ss\" v-if=\"timer !== 0\"\r\n                              @finish=\"timerFinish\"/>\r\n              </el-button>\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"password\">\r\n          <el-input type=\"password\" v-model=\"form.password\" class=\"input-with-select\" clearable>\r\n            <template #prepend>\r\n              修改密码\r\n            </template>\r\n            <template #prefix>\r\n              <font-awesome-icon icon=\"fa-solid fa-lock\"/>\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <div :style=\"{display:'flex',justifyContent:'center',marginTop:'30px'}\">\r\n        <a-button type=\"primary\" class=\"exam-btn\" @click=\"submitForm(passwdFormRef)\">\r\n          提交\r\n        </a-button>\r\n      </div>\r\n\r\n\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.content {\r\n  margin-top: 20px;\r\n  background-color: white;\r\n  border-radius: 5px;\r\n  padding-bottom: 40px;\r\n}\r\n\r\n.exam-btn:hover {\r\n  border: 1px #de1c31 solid;\r\n  box-shadow: none;\r\n  color: #de1c31;\r\n}\r\n</style>","import script from \"./editPasswd.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./editPasswd.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./editPasswd.vue?vue&type=style&index=0&id=07325228&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-07325228\"]])\n\nexport default __exports__"],"names":["form","ref","email","password","verificationCode","passwdFormRef","onMounted","value","store","userInfo","openNotificationWithIcon","type","title","description","notification","message","duration","timer","getCodeBtn","text","disabled","getCode","requestService","post","to","subject","msg","then","res","data","code","Date","now","timerFinish","rules","reactive","required","trigger","emailBlur","submitForm","async","formEl","validate","valid","fields","updatePasswd","put","headers","localStorage","removeItem","isLogin","active","router","push","__exports__"],"sourceRoot":""}