{"version":3,"file":"js/421.f05d8e91.js","mappings":"iKAGO,MAAMA,GAAiBC,EAAAA,EAAAA,IAAY,YAAa,CACnDC,MAAOA,KACK,CACJC,IAAK,KAGbC,QAAS,CAAC,EACVC,QAAS,CAAC,G,qCCRd,IAAIC,EAAM,8BAEV,MAAMC,EAAS,CACXC,UAAW,KACXC,KAAMA,KACFF,EAAOC,UAAY,IAAIE,UAAUJ,GACjCC,EAAOC,UAAUG,UAAaC,IAC1BC,QAAQC,IAAIF,GACDG,KAAKC,MAAMJ,EAAEK,MAIxB,MAAMC,GAAMlB,EAAAA,EAAAA,KACZa,QAAQC,IAAI,SAAUF,EAAEK,MACxBC,EAAIf,IAAMS,EAAEK,IAAI,EAGpBV,EAAOC,UAAUW,QAAWP,IACxBC,QAAQC,IAAIF,EAAE,CACjB,EAGLQ,KAAOR,IACiC,IAAhCL,EAAOC,UAAUa,WACjBC,YAAW,KACPf,EAAOC,UAAUY,KAAKL,KAAKQ,UAAUX,GAAG,GACzC,KAEHL,EAAOC,UAAUY,KAAKL,KAAKQ,UAAUX,GACzC,GAIR,K,sfCWA,MAAMY,GAAWC,EAAAA,EAAAA,IAAI,CAAC,GAChBC,GAASD,EAAAA,EAAAA,IAAI,KAEnBE,EAAAA,EAAAA,KAAU,MACFC,EAAAA,EAAAA,IAAoB,UAEtBJ,EAASK,OAAQD,EAAAA,EAAAA,IAAoB,YAAYJ,SACjDE,EAAOG,OAAQD,EAAAA,EAAAA,IAAoB,YAAYJ,SAASE,OACxDI,MAEAC,aAAaC,WAAW,YACxBD,aAAaC,WAAW,SACxBD,aAAaC,WAAW,OACxBD,aAAaC,WAAW,QACxBC,EAAAA,EAAOC,QAAQ,UACjB,IAGJ,MAAMJ,EAAiBA,KACrBK,QAAQC,UACHC,MAAK,KACJ9B,EAAAA,EAAOE,MAAM,IAEd4B,MAAK,KACJ9B,EAAAA,EAAOa,KAAK,CAACkB,KAAKV,EAAAA,EAAAA,IAAoB,OAAQW,KAAM,GAAG,GACvD,E,4lCCjER,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://simida-web/./src/store/websocket.js","webpack://simida-web/./src/utils/websocket.js","webpack://simida-web/./src/views/chatModel/index.vue","webpack://simida-web/./src/views/chatModel/index.vue?e40f"],"sourcesContent":["import {defineStore} from \"pinia\";\n\n\nexport const websocketStore = defineStore(\"websocket\", {\n    state: () => {\n        return ({\n            msg: '',\n        })\n    },\n    getters: {},\n    actions: {}\n})\n","import {websocketStore} from \"@/store/websocket\";\n\nlet url = \"ws://101.43.187.158:8005/ws\";  //请求的后端地址\n\nconst socket = {\n    websocket: null,\n    init: () => {\n        socket.websocket = new WebSocket(url);\n        socket.websocket.onmessage = (e) => {\n            console.log(e);\n            let data = JSON.parse(e.data);\n            // if (data.type === 3) {\n            //     window.location.href = \"/chat/call?from=\" + data.from + \"&type=2\";\n            // } else {\n            const web = websocketStore();\n            console.log(\"e.data\", e.data);\n            web.msg = e.data;\n            // }\n        };\n        socket.websocket.onclose = (e) => {\n            console.log(e);\n        };\n    },\n\n    send: (e) => {\n        if (socket.websocket.readyState === 0) {\n            setTimeout(() => {\n                socket.websocket.send(JSON.stringify(e));\n            }, 1000);\n        } else {\n            socket.websocket.send(JSON.stringify(e));\n        }\n    }\n};\n\nexport default socket;\n","<template>\r\n  <div class=\"home\">\r\n    <div class=\"home-cont\">\r\n      <el-affix :offset=\"80\" :style=\"{width:'80px',backgroundColor:'rgba(247, 247, 247, 0.9)'}\">\r\n        <div class=\"home-cont-left\">\r\n          <div class=\"home-cont-left-top\">\r\n            <!--          <img :src=\"userInfo.avatar\" class=\"home-cont-left-img\" alt=\"头像未加载\">-->\r\n            <router-link tag=\"div\" to=\"/chat/list\" class=\"home-icon\" replace>\r\n              <el-icon size=\"27\" color=\"#9f9d99\">\r\n                <ChatDotSquare/>\r\n              </el-icon>\r\n            </router-link>\r\n            <router-link tag=\"div\" to=\"/chat/add\" class=\"home-icon\" replace>\r\n              <el-icon size=\"27\" color=\"#9f9d99\">\r\n                <User/>\r\n              </el-icon>\r\n            </router-link>\r\n          </div>\r\n          </div>\r\n        </el-affix>\r\n\r\n      <div class=\"home-cont-right\">\r\n        <router-view style=\"background-color: #fff\"></router-view>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n  <a-layout-footer class=\"footer\" style=\"text-align: center; width:100%; min-width:1178px;}\">\r\n    ❤️Copyright © 2023 - 2023 <a href=\"https://www.cikian.cn\">Cikian</a> | Powered by <a href=\"https://www.cikian.cn\">Cikian</a>\r\n    &amp; shirley ❤️\r\n  </a-layout-footer>\r\n</template>\r\n\r\n\r\n<script setup>\r\n\r\nimport router from \"@/router\";\r\nimport {onMounted, ref} from \"vue\";\r\nimport socket from \"@/utils/websocket\";\r\nimport {ChatDotSquare, User} from \"@element-plus/icons-vue\";\r\nimport {store} from \"@/store\";\r\nimport {getLocalStorageItem} from \"@/utils/data\";\r\n\r\n// 定义用户信息，用于接收后端返回的用户信息\r\nconst userInfo = ref({});\r\nconst avatar = ref(\"\");\r\n\r\nonMounted(() => {\r\n    if (getLocalStorageItem(\"token\")) {\r\n      // userInfo.value = JSON.parse(JSON.stringify(store.userInfo))\r\n      userInfo.value = getLocalStorageItem(\"userInfo\").userInfo\r\n      avatar.value = getLocalStorageItem(\"userInfo\").userInfo.avatar\r\n      loginWebsocket();\r\n    } else {\r\n      localStorage.removeItem(\"userInfo\");\r\n      localStorage.removeItem(\"token\");\r\n      localStorage.removeItem(\"uid\");\r\n      localStorage.removeItem(\"tour\");\r\n      router.replace(\"/login\");\r\n    }\r\n});\r\n\r\nconst loginWebsocket = () => {\r\n  Promise.resolve()\r\n      .then(() => {\r\n        socket.init();\r\n      })\r\n      .then(() => {\r\n        socket.send({uid: getLocalStorageItem(\"uid\"), type: 1});\r\n      });\r\n};\r\n\r\n\r\n</script>\r\n\r\n\r\n<style scoped>\r\nhtml{\r\n}\r\n.home {\r\n  background-color: rgba(128, 128, 128, 0.63);\r\n  min-width: 1178px;\r\n  padding-top: 150px ;\r\n  //padding-bottom: 40px ;\r\n  width: 100%;\r\n  display: flex;\r\n  //align-items: center;\r\n  justify-content: center;\r\n  height: 100vh;\r\n}\r\n\r\n.home-cont {\r\n  display: flex;\r\n  width: 80%;\r\n  max-width: 1000px;\r\n  height: 65vh;\r\n  background: #fff;\r\n}\r\n\r\n.home-cont-left {\r\n\r\n  border-right: 1px solid #eee;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n\r\n\r\n.home-cont-right {\r\n  flex: 9;\r\n}\r\n\r\n.home-cont-left-img {\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 5px;\r\n  margin-right: 5px;\r\n}\r\n\r\n.home-cont-left-top {\r\n\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  height: 200px;\r\n}\r\n\r\n.home-icon {\r\n  height: 50px;\r\n  margin-top: 20px;\r\n  cursor: pointer;\r\n\r\n}\r\n\r\n.router-link-active i {\r\n  color: red;\r\n}\r\n\r\n.footer {\r\n  z-index: 1000;\r\n  background-color: #1c1c1c;\r\n  min-width: 1178px;\r\n  width: 100%;\r\n  margin-top: 20px;\r\n  height: 10vh;\r\n  line-height: 50px;\r\n  font-size: 15px;\r\n  color: #eeeeee;\r\n  position: fixed;\r\n  bottom: 0;\r\n  max-height: 120px;\r\n}\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=46852d7d&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-46852d7d\"]])\n\nexport default __exports__"],"names":["websocketStore","defineStore","state","msg","getters","actions","url","socket","websocket","init","WebSocket","onmessage","e","console","log","JSON","parse","data","web","onclose","send","readyState","setTimeout","stringify","userInfo","ref","avatar","onMounted","getLocalStorageItem","value","loginWebsocket","localStorage","removeItem","router","replace","Promise","resolve","then","uid","type","__exports__"],"sourceRoot":""}